<div class="polis-container">
    <div class="polis-map-container">
        <h2 class="polis-map-container__title">{{ votes.3900.shortTitle }}</h2>
        <p class="polis-map-container__info">{{ votes.3900.title }}</p>
        {# Endresultat #}
        <p class="polis-result-title">
            <span class="polis-result-title__type">{% if voteCase.active %}Resultat{% else %}Endresultat{% endif %}</span>&nbsp;
            <time class="polis-result-title__time">{% if voteCase.active %}{{ votes.3900.results.nationalResults.update|date("H:i") }}{% else %} vom {{ voteCase.update|date("d.m.Y") }}{% endif %}</time>
        </p>
        {% set resultRelativeYes = votes.3900.results.nationalResults.relative.yes|number_format(1, '.', '') %}
        {% set resultRelativeNo = votes.3900.results.nationalResults.relative.no|number_format(1, '.', '') %}
        <ul class="polis-result-container">
            <li class="polis-result polis-result--yes" style="width: {{ resultRelativeYes }}%">
                <p class="polis-result__title polis-result__title--yes">JA</p>
                <div class="polis-result__bar polis-result__bar--main polis-result__bar--yes">
                    <p class="polis-result-relativ"><span
                                class="polis-result-relativ__number">{{ resultRelativeYes }}</span>%</p>
                </div>
                <p class="polis-result__text">
                    {{ votes.3900.results.nationalResults.absolute.yes|number_format(0, '', '\'') }} Stimmen
                </p>
            </li>
            <li class="polis-result polis-result--no" style="width: {{ resultRelativeNo }}%">
                <p class="polis-result__title polis-result__title--no">NEIN</p>
                <div class="polis-result__bar polis-result__bar--main polis-result__bar--no">
                    <p class="polis-result-relativ"><span
                                class="polis-result-relativ__number">{{ resultRelativeNo }}</span>%</p>
                </div>
                <p class="polis-result__text">
                    {{ votes.3900.results.nationalResults.absolute.no|number_format(0, '', '\'') }} Stimmen
                </p>
            </li>
        </ul>
        {% if votes.3900.needsCantonalMajority %}
            <p class="polis-result-title">Standesstimmen</p>
            {% set resultAbsoluteYes = votes.3900.cantonalResult.absolute.yes|number_format(1, '.', '') %}
            {% set resultAbsoluteNo = votes.3900.cantonalResult.absolute.no|number_format(1, '.', '') %}
            <ul class="polis-result-container">
                <li class="polis-result polis-result--yes" style="width: {{ resultAbsoluteYes }}%">
                    <span class="h-offscreen">JA</span>
                    <div class="polis-result__bar polis-result__bar--yes">
                        <p class="polis-result-relativ"><span
                                    class="polis-result-relativ__number">{{ resultAbsoluteYes }}</span></p>
                    </div>
                </li>
                <li class="polis-result polis-result--no" style="width: {{ resultAbsoluteNo }}%">
                    <span class="h-offscreen">NEIN</span>
                    <div class="polis-result__bar polis-result__bar--no">
                        <p class="polis-result-relativ"><span
                                    class="polis-result-relativ__number">{{ resultAbsoluteNo }}</span></p>
                    </div>
                </li>
            </ul>
        {% endif %}

        <figure id="map-1453" class="polis-map" data-vote="3893" data-api="../../assets/demo/polis-data.json"
                aria-hidden="true">
            {# <style type="text/css">
                .chmap__location:hover, .chmap__location:hover {
                    stroke: black;
                    stroke-width: .5px;
                    filter: url(#drop-shadow);
                } /* this isn't working properly yet! */
            </style>  #}
            {% include "elements-chmap.svg" %}
            {% if votes.3900.results.nationalResults.relative.participation > 0 %}
                <p class="polis-map__participation">
                    Stimmbeteiligung {{ votes.3900.results.nationalResults.relative.participation }}%
                </p>
            {% endif %}

            {% include "_polis-legend.twig" %}

        </figure>
    </div>
    {# Abstand ... #}
    <div class="polis-select-container">
        {% if votes.3900.results.results.0.dataCondition.value == "Resultat" %}{# ==> only if at least one canton is selectable!! #}
        {% include 'elements-select' with { 'menu': menu } %}
        {% set bezirke = '' %}
        {% for vote in votes.3900.results.results %}{# TMP !! #}
            {% if vote.location.type.name == "Kanton" and vote.location.shortName == "ZH" %}
                {# Kantone werden nur angezeigt, wenn Endresultat da, oder??? #}
                <p class="polis-result-title polis-result-title--canton">Endresultat
                    Kanton {{ vote.location.locationName }}</p>

                <ul id="result-{{ vote.location.shortName }}"
                    class="polis-result-container polis-result-container--canton polis-result-container--hide">
                    <li class="polis-result polis-result--yes" style="width: {{ resultRelativeYes }}%">
                        <p class="polis-result__title polis-result__title--yes">JA</p>
                        <div class="polis-result__bar polis-result__bar--yes">
                            <p class="polis-result-relativ"><span
                                        class="polis-result-relativ__number">{{ resultRelativeYes }}</span>%</p>
                        </div>
                        <p class="polis-result__text">
                            {{ votes.3900.results.nationalResults.absolute.yes|number_format(0, '', '\'') }} Stimmen
                        </p>
                    </li>
                    <li class="polis-result polis-result--no" style="width: {{ resultRelativeNo }}%">
                        <p class="polis-result__title polis-result__title--no">NEIN</p>
                        <div class="polis-result__bar polis-result__bar--no">
                            <p class="polis-result-relativ"><span
                                        class="polis-result-relativ__number">{{ resultRelativeNo }}</span>%</p>
                        </div>
                        <p class="polis-result__text">
                            {{ votes.3900.results.nationalResults.absolute.no|number_format(0, '', '\'') }} Stimmen
                        </p>
                    </li>
                </ul>
            {% elseif vote.location.type.name == "Bezirk" and vote.location.parentLocationId == 29 %}
                {% set yes_class = vote.relative.yes > 50 ? ' polis--yes' : '' %}
                {% set no_class = vote.relative.no > 50 ? ' polis--no' : '' %}
                {% set bezirke = bezirke ~
                '<li class="polis-district">
                        <span class="polis-district__name">' ~ vote.location.locationName ~ '</span>
                        <span class="polis-district__votes' ~ yes_class ~ '">' ~ vote.relative.yes|number_format(1, '.', '') ~ ' JA</span>
                        <span class="polis-district__votes' ~ no_class ~ '">' ~ vote.relative.no|number_format(1, '.', '') ~ ' NEIN</span>
                    </li>' %}
            {% endif %}
        {% endfor %}
    </div>{# end polis-select-container #}
    <ul id="result-bezirk-ZH" class="polis-district-container">{{ bezirke|raw }}</ul>
{% else %}
    <p class="regional-results-message" style="display: none;">Keine Resultate vorhanden</p>
    {% endif %}
    {#  <a href="#" class="toggle-district">
            <span class="text-active">Bezirksresultate verbergen</span>
            <span class="text-passive">Bezirksresultate anzeigen</span>
            <span class="chevron">Auf / Zuklappen</span>
        </a>
        #}
</div>